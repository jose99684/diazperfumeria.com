!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():(t.ecom=e(),t.EComModal=function(t,e){EComModal.prototype.init=function(){this.modal=new ecom.modal(e);var o=this;if(t)return t.length?t.forEach(function(e,o){s(e,t)}):s(t),this;function s(t,s=null){t.addEventListener("click",function(l){l.preventDefault(),l.stopPropagation();var n=t.getAttribute("ecom-modal")||"inline",a="",r="";if(!(a=i(t))){console.log("Source not found");return}let d=t.querySelector("video")||t.nextElementSibling;if(d&&"VIDEO"===d.tagName&&!d.paused&&d.pause(),"inline"==n){var c=document.querySelector(a);c&&(r=c.outerHTML)}else"image"==n||"iframe"==n&&e.gallery?r=e.gallery?function t(e,o){var s=0;if(0!=o.length){e&&(s=Array.from(o).findIndex(function(t){return t==e}));var l='<div class="ecom-modal-gallery" data-index="'+s+'"><div class="ecom-swiper-wrapper">';return o.forEach(function(t){var e=t.getAttribute("ecom-modal")||"inline";"image"==e?l+='<div class="ecom-modal-gallery-item ecom-swiper-slide"><div class="ecom-swiper-zoom-container"><img src='+i(t)+" /></div></div>":"iframe"==e&&(l+='<div class="ecom-modal-gallery-item ecom-swiper-slide"><div class="ecom-swiper-zoom-container"><video controls style="width: 100%; height: 100%"><source src="'+i(t)+'"/></video></div></div>')}),l+='</div><div class="ecom-swiper-button-prev ecom-swiper-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><path d="M231.3 473.9l19.8-19.8c4.7-4.7 4.7-12.3 0-17L70.4 256 251.1 74.9c4.7-4.7 4.7-12.3 0-17L231.3 38.1c-4.7-4.7-12.3-4.7-17 0L4.9 247.5c-4.7 4.7-4.7 12.3 0 17L214.3 473.9c4.7 4.7 12.3 4.7 17 0z"/></svg></div><div class="ecom-swiper-button-next ecom-swiper-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><path d="M24.7 38.1L4.9 57.9c-4.7 4.7-4.7 12.3 0 17L185.6 256 4.9 437.1c-4.7 4.7-4.7 12.3 0 17L24.7 473.9c4.7 4.7 12.3 4.7 17 0l209.4-209.4c4.7-4.7 4.7-12.3 0-17L41.7 38.1c-4.7-4.7-12.3-4.7-17 0z"/></svg></div></div>'}}(t,s):"<img src="+a+" />":"iframe"==n&&(r=`<video controls style="width: 100%; height: 100%"><source src="${i(t)}"/></video>`);o.modal.setContent(r),o.modal.open()});function i(t){var e="";return t.getAttribute("ecom-modal-source")?e=t.getAttribute("ecom-modal-source"):t.getAttribute("href")?e=t.getAttribute("href"):t.getAttribute("src")&&(e=t.getAttribute("src")),e}}},EComModal.prototype.close=function(){this.modal.close()},this.init()})}(this,function(){var t=!1;function e(t){this.opts=function t(){for(var e=1;e<arguments.length;e++)for(var o in arguments[e])arguments[e].hasOwnProperty(o)&&(arguments[0][o]=arguments[e][o]);return arguments[0]}({},{onClose:null,onOpen:null,beforeOpen:null,beforeClose:null,stickyFooter:!1,footer:!1,cssClass:[],closeLabel:"Close",closeMethods:["overlay","button","escape"],gallery:!1},t),this.init()}function o(){this.modalBoxFooter&&(this.modalBoxFooter.style.width=this.modalBox.clientWidth+"px",this.modalBoxFooter.style.left=this.modalBox.offsetLeft+"px")}function s(){this.modal=document.createElement("div"),this.modal.classList.add("ecom-modal"),(0===this.opts.closeMethods.length||-1===this.opts.closeMethods.indexOf("overlay"))&&this.modal.classList.add("ecom-modal--noOverlayClose"),this.modal.style.display="none",this.opts.cssClass.forEach(function(t){"string"==typeof t&&this.modal.classList.add(t)},this),-1!==this.opts.closeMethods.indexOf("button")&&(this.modalCloseBtn=document.createElement("button"),this.modalCloseBtn.type="button",this.modalCloseBtn.classList.add("ecom-modal__close"),this.modalCloseBtnIcon=document.createElement("span"),this.modalCloseBtnIcon.classList.add("ecom-modal__closeIcon"),this.modalCloseBtnIcon.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M380.2 453.7c5.703 6.75 4.859 16.84-1.891 22.56C375.3 478.7 371.7 480 368 480c-4.547 0-9.063-1.938-12.23-5.657L192 280.8l-163.8 193.6C25.05 478.1 20.53 480 15.98 480c-3.641 0-7.313-1.25-10.31-3.781c-6.75-5.719-7.594-15.81-1.891-22.56l167.2-197.7L3.781 58.32c-5.703-6.75-4.859-16.84 1.891-22.56c6.75-5.688 16.83-4.813 22.55 1.875L192 231.2l163.8-193.6c5.703-6.688 15.8-7.563 22.55-1.875c6.75 5.719 7.594 15.81 1.891 22.56l-167.2 197.7L380.2 453.7z"/></svg>',this.modalCloseBtnLabel=document.createElement("span"),this.modalCloseBtnLabel.classList.add("ecom-modal__closeLabel"),this.modalCloseBtnLabel.innerHTML=this.opts.closeLabel,this.modalCloseBtn.appendChild(this.modalCloseBtnIcon),this.modalCloseBtn.appendChild(this.modalCloseBtnLabel)),this.modalBox=document.createElement("div"),this.modalBox.classList.add("ecom-modal-box"),this.modalBoxContent=document.createElement("div"),this.modalBoxContent.classList.add("ecom-modal-box__content"),this.modalBox.appendChild(this.modalBoxContent),-1!==this.opts.closeMethods.indexOf("button")&&this.modal.appendChild(this.modalCloseBtn),this.modal.appendChild(this.modalBox)}function i(){this._events={clickCloseBtn:this.close.bind(this),clickOverlay:n.bind(this),resize:this.checkOverflow.bind(this),keyboardNav:l.bind(this)},-1!==this.opts.closeMethods.indexOf("button")&&this.modalCloseBtn.addEventListener("click",this._events.clickCloseBtn),this.modal.addEventListener("click",this._events.clickOverlay),window.addEventListener("resize",this._events.resize),document.addEventListener("keydown",this._events.keyboardNav)}function l(t){-1!==this.opts.closeMethods.indexOf("escape")&&27===t.which&&this.isOpen()&&this.close()}function n(t){var e=this.modal.offsetWidth-this.modal.clientWidth,o=t.clientX>=this.modal.offsetWidth-15,s=this.modal.scrollHeight!==this.modal.offsetHeight;("MacIntel"!==navigator.platform||0!==e||!o||!s)&&-1!==this.opts.closeMethods.indexOf("overlay")&&!function t(e,o){for(;(e=e.parentElement)&&!e.classList.contains(o););return e}(t.target,"ecom-modal")&&t.clientX<this.modal.clientWidth&&this.close()}function a(){-1!==this.opts.closeMethods.indexOf("button")&&this.modalCloseBtn.removeEventListener("click",this._events.clickCloseBtn),this.modal.removeEventListener("mousedown",this._events.clickOverlay),window.removeEventListener("resize",this._events.resize),document.removeEventListener("keydown",this._events.keyboardNav)}return e.prototype.init=function(){if(this.modal)return;s.call(this),i.call(this);let t="."+this.modal.className.replaceAll(" ","."),e=document.querySelector(t);return e&&document.body.removeChild(e),document.body.appendChild(this.modal,document.body.firstChild),this},e.prototype.galleryInit=function(){if(!window.EComSwiper)return;var t=this.modal.querySelector(".ecom-modal-gallery"),e=t.dataset.index?t.dataset.index:0;new window.EComSwiper(t,{initialSlide:e,freeMode:!1,centeredSlides:!0,loop:!1,centeredSlidesBounds:!0,autoHeight:!1,slidesPerView:1,spaceBetween:0,zoom:!0,navigation:{nextEl:".ecom-swiper-button-next",prevEl:".ecom-swiper-button-prev"}});let o=null;this.modal.querySelectorAll("img").forEach(function(t){t.addEventListener("load",function(){clearTimeout(o),o=setTimeout(()=>window.dispatchEvent(new window.Event("resize")),500)})})},e.prototype._busy=function(e){t=e},e.prototype._isBusy=function(){return t},e.prototype.destroy=function(){null!==this.modal&&(this.isOpen()&&this.close(!0),a.call(this),this.modal.parentNode.removeChild(this.modal),this.modal=null)},e.prototype.isOpen=function(){return!!this.modal.classList.contains("ecom-modal--visible")},e.prototype.open=function(){if(!this._isBusy())return this._busy(!0),"function"==typeof this.opts.beforeOpen&&this.opts.beforeOpen(),this.modal.style.removeProperty?this.modal.style.removeProperty("display"):this.modal.style.removeAttribute("display"),document.getSelection().removeAllRanges(),this._scrollPosition=window.pageYOffset,document.body.classList.add("ecom-enabled"),document.body.style.top=-this._scrollPosition+"px",this.modal.classList.add("ecom-modal--visible"),this.opts.gallery&&this.galleryInit(),"function"==typeof this.opts.onOpen&&this.opts.onOpen.call(this),this._busy(!1),this.checkOverflow(),this},e.prototype.close=function(t){let e=this.modalBoxContent.querySelectorAll("video");if(e.forEach(t=>{t.pause()}),!this._isBusy()){if(this._busy(!0),t=t||!1,"function"==typeof this.opts.beforeClose&&!this.opts.beforeClose.call(this)){this._busy(!1);return}document.body.classList.remove("ecom-enabled"),document.body.style.top=null,window.scrollTo({top:this._scrollPosition,behavior:"instant"}),this.modal.classList.remove("ecom-modal--visible");var o=this;o.modal.style.display="none","function"==typeof o.opts.onClose&&o.opts.onClose.call(this),o._busy(!1)}},e.prototype.setContent=function(t){return"string"==typeof t?this.modalBoxContent.innerHTML=t:(this.modalBoxContent.innerHTML="",this.modalBoxContent.appendChild(t)),this.isOpen()&&this.checkOverflow(),this},e.prototype.getContent=function(){return this.modalBoxContent},e.prototype.resize=function(){console.warn("Resize is deprecated and will be removed in version 1.0")},e.prototype.isOverflow=function(){var t=window.innerHeight;return this.modalBox.clientHeight>=t},e.prototype.checkOverflow=function(){this.modal.classList.contains("ecom-modal--visible")&&(this.isOverflow()?this.modal.classList.add("ecom-modal--overflow"):this.modal.classList.remove("ecom-modal--overflow"),!this.isOverflow()&&this.opts.stickyFooter?this.setStickyFooter(!1):this.isOverflow()&&this.opts.stickyFooter&&(o.call(this),this.setStickyFooter(!0)))},e.prototype.resize,{modal:e}});